Groovy

Node { // ------------------------------------ // - STAGE: Compile // - ----------------------------------- 
   stage 'Compile'
   
   
   
   
   // - Set variables 
   echo 'Configuring variables' def mvnHome = tool 'M3' 
   env . PATH = "$ {mvnHome} / bin: $ {env.PATH}" 
   echo "var mvnHome = '$ {mvnHome}'" 
   echo "var env.PATH = '$ {env.PATH}'"
    
   
   // - Download code from SCM 
   echo 'Downloading SCM code' 
   sh 'rm -rf *'
   Checkout scm
   
   // - Compiling 
   echo 'Compiling application' 
   sh 'mvn clean compile'
   
   ]) If ( currentBuild . Result == 'UNSTABLE' ) 
         currentBuild . Result = 'FAILURE' throw err
    }
   
   
     
      
         
      
   
   // ------------------------------------ // - STAGE: Install // --- --------------------------------- 
   stage 'Install' 
   echo 'Installs the generated package in the maven' 
   sh ' repository Mvn install -Dmaven.test.skip = true '
   
   
   
   // ------------------------------------ // - STAGE: Archive // --- --------------------------------- 
   stage 'Archive' 
   echo 'File the package generated in Jenkins' 
   step ( [ $ Class : 'ArtifactArchiver' , artifacts : '** / target / * .jar, ** / target / * .war' , fingerprint : true ]) }
   
      
